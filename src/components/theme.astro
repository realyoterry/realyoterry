<script is:inline>
  let theme = localStorage.getItem('lightMode');
  const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;

  if (theme === 'true') {
    document.documentElement.classList.add('dark');
  }

  if (!theme) {
    theme = prefersDark ? 'false' : 'true';
    localStorage.setItem('lightMode', theme);
    document.documentElement.classList.add('dark');
  }

  document.addEventListener('DOMContentLoaded', () => {
    const sunIcon = document.getElementById('sunIcon');
    const moonIcon = document.getElementById('moonIcon');

    if (theme === 'false') {
        window.dispatchEvent(new CustomEvent('themeChange', { detail: 'dark' }));
      sunIcon.classList.add('opacity-0');
      moonIcon.classList.remove('opacity-0');
    }

    if (theme === 'true') {
        window.dispatchEvent(new CustomEvent('themeChange', { detail: 'light' }));
      sunIcon.classList.remove('opacity-0');
      moonIcon.classList.add('opacity-0');
    }
  });
</script>
